//---------------------------------------------------------------------------

#include <vcl.h>
#pragma hdrstop

#include "DeleteClient.h"
//---------------------------------------------------------------------------
#pragma package(smart_init)
#pragma resource "*.dfm"
TForm9 *Form9;
//---------------------------------------------------------------------------
__fastcall TForm9::TForm9(TComponent* Owner)
	: TForm(Owner)
{
}
//---------------------------------------------------------------------------

void __fastcall TForm6::ButtonDeleteClick(TObject *Sender) {
    if (ListBoxWorkers->ItemIndex != -1) {
		try {
			ADOQuery->SQL->Text = "DELETE FROM Клиенты WHERE ФИО = :Name";
			ADOQuery->Parameters->ParamByName("Name")->Value = ListBoxWorkers->Items->Strings[ListBoxWorkers->ItemIndex];
			ADOQuery->ExecSQL();
            LoadWorkers();

			MessageDlg("Запись успешно удалена!", mtInformation, TMsgDlgButtons() << mbOK, 0);
        }
		catch (Exception &E) {
            MessageDlg("Ошибка при удалении записи: " + E.Message, mtError, TMsgDlgButtons() << mbOK, 0);
        }
	}
}
