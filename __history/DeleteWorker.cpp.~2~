//---------------------------------------------------------------------------

#include <vcl.h>
#pragma hdrstop

#include "DeleteWorker.h"
//---------------------------------------------------------------------------
#pragma package(smart_init)
#pragma resource "*.dfm"
TForm6 *Form6;
//---------------------------------------------------------------------------
__fastcall TForm6::TForm6(TComponent* Owner)
	: TForm(Owner)
{
	LoadWorkers();
}
//---------------------------------------------------------------------------
void TDeleteForm::LoadWorkers() {
    ListBoxWorkers->Clear();
    ADOQuery->SQL->Text = "SELECT * FROM Работники";
    ADOQuery->Open();
    while (!ADOQuery->Eof) {
		ListBoxWorkers->Items->Add(ADOQuery->FieldByName("ФИО")->AsString);
        ADOQuery->Next();
    }
    ADOQuery->Close();
}


void __fastcall TDeleteForm::ButtonDeleteClick(TObject *Sender) {
    if (ListBoxWorkers->ItemIndex != -1) {
		ADOQuery->SQL->Text = "DELETE FROM Работники WHERE ФИО = :Name";
        ADOQuery->Parameters->ParamByName("Name")->Value = ListBoxWorkers->Items->Strings[ListBoxWorkers->ItemIndex];
        ADOQuery->ExecSQL();
		LoadWorkers();
    }
}
