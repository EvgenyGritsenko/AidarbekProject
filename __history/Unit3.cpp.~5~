//---------------------------------------------------------------------------

#include <vcl.h>
#pragma hdrstop

#include "Unit3.h"
//---------------------------------------------------------------------------
#pragma package(smart_init)
#pragma resource "*.dfm"
TForm3 *Form3;
//---------------------------------------------------------------------------
__fastcall TForm3::TForm3(TComponent* Owner)
	: TForm(Owner)
{
    try {
		// Подключение к базе данных
//        ADOConnection1->Connected = true;

        // Запрос для получения количества продаж
        ADOQuery1->SQL->Clear();
		ADOQuery1->SQL->Add("SELECT COUNT(*) AS SaleCount FROM Продажи"); // Замените SalesTable на реальное название таблицы продаж
        ADOQuery1->Open();
        Label1->Caption = "Количество продаж: " + ADOQuery1->FieldByName("SaleCount")->AsString;

        // Запрос для получения количества автозапчастей
        ADOQuery1->SQL->Clear();
		ADOQuery1->SQL->Add("SELECT COUNT(*) AS PartsCount FROM Автозапчасти"); // Замените PartsTable на реальное название таблицы автозапчастей
        ADOQuery1->Open();
        Label2->Caption = "Количество автозапчастей: " + ADOQuery1->FieldByName("PartsCount")->AsString;

        // Запрос для получения общего количества покупок клиентов
        ADOQuery1->SQL->Clear();
		ADOQuery1->SQL->Add("SELECT COUNT(*) AS TotalPurchases FROM Клиенты"); // Замените PurchasesTable на реальное название таблицы покупок
        ADOQuery1->Open();
		Label3->Caption = "Количество клиентов: " + ADOQuery1->FieldByName("TotalPurchases")->AsString;

        // Запрос для получения работника с наибольшим количеством продаж
        ADOQuery1->SQL->Clear();
        ADOQuery1->SQL->Add(
			"SELECT TOP 1 [Кол-во покупок], COUNT(*) AS [SalesCount] "
			"FROM Клиенты "
			"GROUP BY [Кол-во покупок] "
            "ORDER BY [SalesCount] DESC"
        ); // Замените EmployeeName на имя колонки с именем работника и SalesTable на реальное название таблицы продаж
        ADOQuery1->Open();
        Label4->Caption = "Работник с наибольшим количеством продаж: " + ADOQuery1->FieldByName("EmployeeName")->AsString;

    } catch (Exception &E) {
        ShowMessage("Ошибка при подключении к БД: " + E.Message);
	}
}
//---------------------------------------------------------------------------
